<div ng-include="'components/navbar/navbar.html'"></div>

<div class="col-md-12" ng-controller="JobsCtrl">
    <!-- <div ng-controller='MessagesCtrl'>
      <form ng-submit="sendApplication()">
        To: <input class='form-control' type="text" ng-model='application.to'>
        Email's Subject Line: <input class='form-control' type="text" ng-model='application.subjectLine'>
        Email's Body Text: <textarea rows='10' class='form-control' type="text" ng-model='application.bodyOfEmail'></textarea>
        <button class='btn btn-danger'>Submit</button>
      </form>
    </div> -->
  <div ng-show='defaultView'>
    <div collapse='isCollapsedShare'>
      <div class="container">
        <div class="row">
          <div class="col-md-6 col-md-offset-3">
            <div class="well well-sm">
              <form class="form-horizontal" ng-submit="shareView()">
              <fieldset>
                <legend class="text-center">Share Pursuits</legend>

                <!-- Share with User input-->
                <div class="form-group">
                  <label class="col-md-3 control-label" for="share">Share with</label>
                  <div class="col-md-9">
                    <input id="share" name="share" placeholder="Enter email address of user to share pursuits with." type="text" class="form-control" ng-model="email.email">
                    <alert ng-show='showEmailError' type='danger' close='closeAlert()'>The email address provided is not a Job Butler user.</alert>
                  </div>
                </div>

                <!-- Form actions -->
                <div class="form-group">
                  <div class="col-md-12 text-right">
                    <button class="btn btn-success btn-lg">Submit</button>
                  </div>
                </div>
              </fieldset>
              </form>
            </div>
          </div>
        </div>
      </div>
      <br><br>
    </div>

    <div collapse='isCollapsedJob'>
      <div ng-include="'app/jobs/addpursuit.html'"></div>
      <br><br>
    </div>

    <div class='row'>
      <div>
        <button class="col-md-1 col-md-offset-5 btn btn-default" ng-click="isCollapsedJob = !isCollapsedJob; isCollapsedShare = true">Add Pursuit</button>
      </div>
      <div>
        <button class="col-md- 1 btn btn-default" ng-click="isCollapsedShare = !isCollapsedShare; isCollapsedJob = true">Share</button>
      </div>
    </div>


  <div>
    <table st-table='jobAppsDisplay' st-safe-src="jobApps" class='table table-striped'>
      <thead>
        <tr>
          <th st-sort='companyName'>Company Name</th>
          <th st-sort='positionTitle'>Position Title</th>
          <th st-sort='stage[stage.length-1].stageName'>Status</th>
          <th st-sort='stage[stage.length-1].date'>Last Updated</th>
          <th>Details</th>
        </tr>
        <tr>
          <th colspan="5">
            <input st-search placeholder="global search" class="input-sm form-control" type="search"/>
          </th>
        </tr>
      </thead>
      <tbody>
        <tr ng-repeat='jobApp in jobAppsDisplay'>
          <td>{{jobApp.companyName}}</td>
          <td>{{jobApp.positionTitle}}</td>
          <td>{{jobApp.stage[jobApp.stage.length-1].stageName}}</td>
          <td>{{jobApp.stage[jobApp.stage.length-1].date}}</td>
          <td><i class="fa fa-pencil-square" ng-click="openDetails(jobApp)"></i></td>
        </tr>
      </tbody>
    </table>
  </div>


<!-- <script type="text/ng-template" id="editJobModal.html">
  <div ng-include="'app/jobs/edit-job-modal.html'"></div>
</script> -->

  </div>
  <!-- Open Detail View -->
  <div ng-show='detailView' class='row'>
    <div class='col-md-12'>
      <div class='col-md-2 col-md-offset-10'>
        <button class='btn btn-primary' ng-click='openEdit(jobDetail)'>Edit</button>
      </div>
      <h1>Job Details</h1>
      <div class='jumbotron'>
        <h3>Company Name</h3>
        <p>{{jobDetail.companyName}}</p>
        <h3>Position Title</h3>
        <p>{{jobDetail.positionTitle}}</p>
      </div>
    </div>
  </div>

  <!-- Open Edit View -->
  <div ng-show='editView' class='row'>
    <div class='col-md-12'>
      <form class="form-horizontal">
        <fieldset>

          <legend class="text-center">Edit Pursuit</legend>

          <!-- Company Name input-->
          <div class="form-group">
            <label class="col-md-1 control-label" for="coName">Company Name</label>
            <div class="col-md-11">
              <input id="coName" name="coName" type="text" class="form-control" ng-model="job.companyName">
            </div>
          </div>

          <!-- Position input-->
          <div class="form-group">
            <label class="col-md-1 control-label" for="position">Position Title</label>
            <div class="col-md-11">
              <input id="position" name="position" type="text" class="form-control" ng-model='job.positionTitle'>
            </div>
          </div>

          <!-- Link input-->
          <div class="form-group">
            <label class="col-md-1 control-label" for="positionLink">Link to Posting</label>
            <div class="col-md-11">
              <input id="positionLink" name="positionLink" type="text" class="form-control" ng-model='job.link'>
            </div>
          </div>

          <!-- Stage input-->
          <div class="form-group">
            <label class="col-md-1 control-label" for="stageStatus">Status</label>
            <div class="col-md-11">
              <select id="stageStatus" name="stageStatus" class='form-control' ng-model='job.stage[job.stage.length-1].stageName' ng-options='stage for stage in stages.values'></select>
            </div>
          </div>

          <!-- Notes  -->
          <div class="form-group">
            <label class="col-md-1 control-label" for="notes">Notes</label>
            <div class="col-md-11">
              <textarea class="form-control" id="notes" name="notes" rows="5" ng-model='job.stage[job.stage.length-1].notes'></textarea>
            </div>
          </div>

          <!-- Form actions -->
            <div class="col-md-12">
              <button class="btn btn-primary btn-lg" ng-click="submitJobEdits(job)">Save Changes</button>
              <button class="btn btn-danger btn-lg" ng-click="removeJob(jobModal)">Remove This Job</button>
              <button class="btn btn-warning btn-lg" ng-click="cancelEdit()">Cancel</button>
            </div>
        </fieldset>
      </form>
    </div>
  </div>

</div>


